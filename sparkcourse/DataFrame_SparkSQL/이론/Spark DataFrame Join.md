# Join

## join 종류
- inner join
- left outer join
- right outer join
- full outer join

```python
left_df = spark.createDataFrame([
    ('하명도', 15, date(2022,7,22)),
    ('이제동', 20, date(2021,7,22)),
    ('김명운', 25, date(2020,7,22)),
    ('임요환', 25, date(2020,7,22))
],schema='name string, age int, birth date')

left_df.show()


right_df = spark.createDataFrame([
    ('하명도', 100),
    ('이제동', 90),
    ('김명운', 80),
    ('홍진호', 80)
],schema='name string, score int')

right_df.show()
'''
+------+---+----------+
|  name|age|     birth|
+------+---+----------+
|하명도| 15|2022-07-22|
|이제동| 20|2021-07-22|
|김명운| 25|2020-07-22|
|임요환| 25|2020-07-22|
+------+---+----------+

+------+-----+
|  name|score|
+------+-----+
|하명도|  100|
|이제동|   90|
|김명운|   80|
|홍진호|   80|
+------+-----+
'''
```

### Inner join, Default
```python
left_df.join(right_df, on = 'name').show()

'''
+------+---+----------+-----+
|  name|age|     birth|score|
+------+---+----------+-----+
|김명운| 25|2020-07-22|   80|
|이제동| 20|2021-07-22|   90|
|하명도| 15|2022-07-22|  100|
+------+---+----------+-----+
'''
```

### Left_join
```python
left_df.join(right_df, on = 'name', how = 'left').show()

'''
+------+---+----------+-----+
|  name|age|     birth|score|
+------+---+----------+-----+
|김명운| 25|2020-07-22|   80|
|이제동| 20|2021-07-22|   90|
|임요환| 25|2020-07-22| null|
|하명도| 15|2022-07-22|  100|
+------+---+----------+-----+
'''
```

### Right_join
```python
left_df.join(right_df, on = 'name', how = 'right').show()

'''
+------+----+----------+-----+
|  name| age|     birth|score|
+------+----+----------+-----+
|김명운|  25|2020-07-22|   80|
|이제동|  20|2021-07-22|   90|
|하명도|  15|2022-07-22|  100|
|홍진호|null|      null|   80|
+------+----+----------+-----+
'''
```

### Outer_join
```python
left_df.join(right_df, on = 'name', how = 'outer').show()

'''
+------+----+----------+-----+
|  name| age|     birth|score|
+------+----+----------+-----+
|김명운|  25|2020-07-22|   80|
|이제동|  20|2021-07-22|   90|
|임요환|  25|2020-07-22| null|
|하명도|  15|2022-07-22|  100|
|홍진호|null|      null|   80|
+------+----+----------+-----+
'''
```

### Leftsemi == Semi
- 교집합, 데이터 결합 X
```python
left_df.join(right_df, on = 'name', how = 'leftsemi').show()
left_df.join(right_df, on = 'name', how = 'semi').show()

'''
+------+---+----------+
|  name|age|     birth|
+------+---+----------+
|김명운| 25|2020-07-22|
|이제동| 20|2021-07-22|
|하명도| 15|2022-07-22|
+------+---+----------+

+------+---+----------+
|  name|age|     birth|
+------+---+----------+
|김명운| 25|2020-07-22|
|이제동| 20|2021-07-22|
|하명도| 15|2022-07-22|
+------+---+----------+
'''
```

### Leftanti == Anti
- 차집합
```python
left_df.join(right_df, on = 'name', how = 'leftanti').show()
left_df.join(right_df, on = 'name', how = 'anti').show()

'''
+------+---+----------+
|  name|age|     birth|
+------+---+----------+
|임요환| 25|2020-07-22|
+------+---+----------+

+------+---+----------+
|  name|age|     birth|
+------+---+----------+
|임요환| 25|2020-07-22|
+------+---+----------+
'''
```